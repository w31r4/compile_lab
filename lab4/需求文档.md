收到您的课程任务资料。根据您提供的6份文档（涵盖SysY语言定义、Flex工具指导及4个具体实验任务），我为您梳理了以下两份⽂档：**《核心需求规格说明书 (PRD)》**与**《项目落地实操手册 (SOP)》**。

---

# 文档一：核心需求规格说明书 (Project Brief)
**适用场景**：明确“做什么”、“交什么”以及“验收标准”。

## 1. 项目背景与目标
本项目旨在实现 **SysY语言（2022版）** 的编译器前端。SysY是C语言的一个子集，支持 `int` 和 `float` 类型及多维数组 [source_2]。你需要完成从**语言规范理解**到**词法分析**、**语法分析**，最后进行**静态语义检查**的全过程。

## 2. 核心任务清单 (Functional Requirements)

### 任务 4.1：语言规范理解与测试集构建
*   **目标**：深入理解SysY文法，产出测试代码。
*   **要求**：
    *   编写 **5-10个** `.sy` 格式的测试程序，覆盖所有语法规则（简单+复杂组合）[source_3]。
    *   **强制要求**：测试程序首行必须输出队伍学生的学号或队伍编码 [source_3]。
    *   **交付**：测试程序代码及分析报告。

### 任务 4.2：词法分析器 (Lexical Analyzer)
*   **目标**：将源代码转换为词法单元流，识别非法字符。
*   **输入**：SysY源代码文件（如 `./ss test1.sy`）[source_4]。
*   **输出标准**：
    *   **正常情况**：输出词法单元二元组列表 `<词法单元类型, 属性值>` [source_4]。
    *   **异常情况**：报告 **Error type A**（非法字符），需包含行号和说明 [source_4]。
*   **技术点**：需处理八进制、十六进制及浮点数识别 [source_4]。

### 任务 4.3：语法分析器 (Syntax Analyzer)
*   **目标**：构建语法分析树，识别语法结构错误。
*   **输出标准**：
    *   **正常情况**：按 **先序遍历** 打印分析树。
        *   语法单元：打印名称 + `(行号)`（产生ε则不打行号）[source_5]。
        *   词法单元：仅打印名称。
        *   特殊要求：`ID` 需打印词素；`INTCON/FLOATCON` 需打印数值；类型关键词需打印具体类型（int/float）[source_5]。
    *   **异常情况**：报告 **Error type B**（语法错误，如缺少分号、括号不匹配），需包含行号 [source_5]。

### 任务 4.4：语义分析 (Semantic Analysis)
*   **目标**：进行静态语义检查（作用域、类型匹配等）。
*   **输出标准**：
    *   **正常情况**：不输出或输出 "success" [source_6]。
    *   **异常情况**：识别并报告 **13种特定类型的语义错误**（如变量未声明、函数参数不匹配、break不在循环内等）[source_6]。

## 3. 非功能性需求与交付标准
*   **环境要求**：Linux系统（推荐），GCC编译器 [source_1]。
*   **实现语言**：推荐使用 Flex (Lex) 和 Bison，也可以手写C/C++ [source_4][source_5]。
*   **报告规范**：
    *   每个小组整合一份PDF，包含所有任务。
    *   字体最小五号，总长度不超过4页（重点描述亮点，杜绝大段贴代码）[source_4][source_5]。
*   **文件格式**：源代码需包含构建脚本（Makefile或说明配置环境），测试文件为 `.sy` [source_3]。

---

# 文档二：项目落地实操手册 (Execution Guide)
**适用场景**：指导“怎么做”、“如何避坑”以及“工具使用”。

## 第一阶段：准备与热身 (针对任务 4.1)
1.  **研读文法**：重点阅读《SysY2022语言定义》，注意2022版新增了 `float` 类型支持，且所有程序必须包含 `main` 函数 [source_2]。
2.  **编写测试用例**：
    *   设计涵盖 `const` 常量、多维数组、`if/else`、`while` 的复杂用例。
    *   **避坑**：确保测试程序能通过GCC编译（SysY是C的子集），验证逻辑正确性 [source_3]。

## 第二阶段：词法分析实战 (针对任务 4.2)
1.  **工具使用 (Flex)**：
    *   利用 Flex 的正则定义部分简化代码（如定义 `digit [0-9]`）[source_1]。
    *   开启 `%option yylineno` 自动记录行号，方便报错 [source_1]。
2.  **关键难点**：
    *   **注释处理**：需要处理单行 `//` 和多行 `/*...*/` 注释，不要让注释里的字符干扰分析。
    *   **数值识别**：需正确识别十六进制（`0x`前缀）和八进制（`0`前缀）并转换为十进制数值打印 [source_4]。
3.  **自检**：输入非法字符（如 `~`），程序应输出 `Error type A at Line X...` [source_4]。

## 第三阶段：语法分析实战 (针对任务 4.3)
1.  **工具配合**：建议结合 Bison 使用。将 Flex 识别的 Token 传递给 Bison 构建语法树。
2.  **输出格式控制**：
    *   **格式陷阱**：语法单元与行号之间要有空格；词法单元信息（如 `ID: main`）之间用冒号加空格分隔 [source_5]。
    *   **优先级处理**：SysY 运算符优先级与 C 语言一致，需在 Bison 中通过 `%left`, `%right` 或文法层级正确定义 [source_2]。
3.  **调试建议**：如果遇到 "Shift/Reduce" 冲突，通常是 `if-else` 的匹配问题（就近匹配原则）[source_2]。

## 第四阶段：语义分析实战 (针对任务 4.4)
1.  **核心架构**：建立**符号表 (Symbol Table)**。
    *   支持作用域嵌套（Scope Stack）：进入 `{` 创建新作用域，退出 `}` 销毁或弹出。
    *   支持重名检查：同作用域下不能重定义，但内部作用域可隐藏外部变量 [source_2]。
2.  **错误检测清单 (Checklist)**：
    *   [ ] 检查变量/函数使用前是否已定义 (Error 1, 3)。
    *   [ ] 检查变量/函数是否重复定义 (Error 2, 4)。
    *   [ ] 检查函数调用参数个数和类型是否匹配 (Error 9)。
    *   [ ] 检查 `return` 类型与函数定义是否一致 (Error 10)。
    *   [ ] 检查数组下标是否为整型 (Error 7) [source_6]。
3.  **类型系统**：注意 SysY 中 `int` 和 `float` 虽有隐式转换，但在本次实验假设中，部分场景（如报错检测）可能需要严格区分类型不匹配的情况（Error 11）[source_6]。

## 最终提交前自查
*   [ ] 所有 `.sy` 测试文件均能被你的程序正确读取。
*   [ ] 错误报告格式严格遵守 `Error type X at Line Y: ...`。
*   [ ] 实验报告PDF已整合，且不超过4页，包含程序亮点与实现原理 [source_4]。

希望这份总结能帮助您清晰地完成课程任务！如果有具体的代码编写问题，欢迎随时提问。