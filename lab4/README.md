# ğŸ”§ SysY ç¼–è¯‘å™¨å‰ç«¯ (Lab 4)

> **SysY 2022 è¯­è¨€ç¼–è¯‘å™¨å‰ç«¯å®ç°**  
> åŒ…å«è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æä¸‰ä¸ªå®Œæ•´é˜¶æ®µ

[![Python](https://img.shields.io/badge/Python-3.14+-blue.svg)](https://www.python.org/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.40+-red.svg)](https://streamlit.io/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

---

## ğŸ“– ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#-é¡¹ç›®æ¦‚è¿°)
- [åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [ä½¿ç”¨æ–¹æ³•](#-ä½¿ç”¨æ–¹æ³•)
- [é”™è¯¯æ£€æµ‹](#-é”™è¯¯æ£€æµ‹)
- [æµ‹è¯•ç”¨ä¾‹](#-æµ‹è¯•ç”¨ä¾‹)
- [æŠ€æœ¯å®ç°](#-æŠ€æœ¯å®ç°)
- [å¼€å‘ä¿¡æ¯](#-å¼€å‘ä¿¡æ¯)

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ç¼–è¯‘åŸç†è¯¾ç¨‹å®éªŒ 4 çš„å®Œæ•´å®ç°ï¼ŒåŸºäº **SysY 2022 è¯­è¨€å®šä¹‰**æ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ç¼–è¯‘å™¨å‰ç«¯ã€‚é¡¹ç›®æ¶µç›–äº†ä»æºä»£ç åˆ°æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰çš„å®Œæ•´ç¼–è¯‘æµç¨‹ï¼Œå¹¶å®ç°äº†å…¨é¢çš„é™æ€è¯­ä¹‰æ£€æŸ¥ã€‚

### ä»€ä¹ˆæ˜¯ SysY è¯­è¨€ï¼Ÿ

SysY æ˜¯ C è¯­è¨€çš„ä¸€ä¸ªå­é›†ï¼Œä¸“ä¸ºç¼–è¯‘åŸç†æ•™å­¦è®¾è®¡ã€‚å®ƒä¿ç•™äº† C è¯­è¨€çš„æ ¸å¿ƒç‰¹æ€§ï¼š

- **æ•°æ®ç±»å‹**ï¼š`int`ã€`float`ã€`void`
- **æ§åˆ¶ç»“æ„**ï¼š`if-else`ã€`while`ã€`break`ã€`continue`ã€`return`
- **å¤åˆç±»å‹**ï¼šå¸¸é‡ã€å˜é‡ã€ä¸€ç»´/å¤šç»´æ•°ç»„
- **å‡½æ•°**ï¼šå‡½æ•°å®šä¹‰ä¸è°ƒç”¨ï¼ˆæ— å‡½æ•°å£°æ˜ï¼‰
- **è¿ç®—ç¬¦**ï¼šç®—æœ¯ã€å…³ç³»ã€é€»è¾‘è¿ç®—ç¬¦

### å®éªŒä»»åŠ¡è¦†ç›–

| ä»»åŠ¡ | æè¿° | çŠ¶æ€ |
|------|------|------|
| ä»»åŠ¡ 4.1 | SysY è¯­è¨€è¯­æ³•å’Œè¯­ä¹‰è§„èŒƒç†è§£ | âœ… å·²å®Œæˆ |
| ä»»åŠ¡ 4.2 | è¯æ³•åˆ†æå™¨è®¾è®¡ä¸å®ç° | âœ… å·²å®Œæˆ |
| ä»»åŠ¡ 4.3 | è¯­æ³•åˆ†æå™¨è®¾è®¡ä¸å®ç° | âœ… å·²å®Œæˆ |
| ä»»åŠ¡ 4.4 | è¯­ä¹‰åˆ†æå™¨è®¾è®¡ä¸å®ç° | âœ… å·²å®Œæˆ |

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ”¤ è¯æ³•åˆ†æå™¨ (Lexer)

- âœ… å®Œæ•´çš„ SysY å…³é”®å­—è¯†åˆ«ï¼ˆ`const`, `int`, `float`, `void`, `if`, `else`, `while`, `break`, `continue`, `return`ï¼‰
- âœ… æ ‡è¯†ç¬¦ä¸ä¿ç•™å­—åŒºåˆ†
- âœ… æ•´å‹å¸¸é‡æ”¯æŒï¼ˆåè¿›åˆ¶ã€å…«è¿›åˆ¶ `0777`ã€åå…­è¿›åˆ¶ `0xFF`ï¼‰
- âœ… æµ®ç‚¹å¸¸é‡æ”¯æŒï¼ˆå«ç§‘å­¦è®¡æ•°æ³• `1.5e-3`ã€åå…­è¿›åˆ¶æµ®ç‚¹ `0x1.5p10`ï¼‰
- âœ… è¿ç®—ç¬¦ä¸åˆ†éš”ç¬¦è¯†åˆ«
- âœ… å•è¡Œ/å¤šè¡Œæ³¨é‡Šè·³è¿‡
- âœ… è¯æ³•é”™è¯¯æ£€æµ‹ä¸æŠ¥å‘Šï¼ˆError Type Aï¼‰

### ğŸŒ³ è¯­æ³•åˆ†æå™¨ (Parser)

- âœ… é€’å½’ä¸‹é™è§£æå™¨å®ç°
- âœ… å®Œæ•´çš„ SysY æ–‡æ³•æ”¯æŒ
- âœ… æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰æ„å»º
- âœ… AST å¯è§†åŒ–è¾“å‡ºï¼ˆå…ˆåºéå†ï¼‰
- âœ… è¯­æ³•é”™è¯¯æ£€æµ‹ä¸æ¢å¤ï¼ˆError Type Bï¼‰

### ğŸ” è¯­ä¹‰åˆ†æå™¨ (Semantic Analyzer)

- âœ… ç¬¦å·è¡¨ç®¡ç†ï¼ˆæ”¯æŒåµŒå¥—ä½œç”¨åŸŸï¼‰
- âœ… ç±»å‹æ£€æŸ¥ç³»ç»Ÿ
- âœ… **17 ç§è¯­ä¹‰é”™è¯¯æ£€æµ‹**ï¼ˆè¶…è¶Šå®éªŒè¦æ±‚çš„ 13 ç§ï¼‰
- âœ… æ•°ç»„è¶Šç•Œé™æ€æ£€æµ‹
- âœ… å¸¸é‡ä¿®æ”¹æ£€æµ‹
- âœ… main å‡½æ•°å­˜åœ¨æ€§æ£€æŸ¥

### ğŸ–¥ï¸ å¯è§†åŒ–ç•Œé¢

- âœ… Streamlit Web åº”ç”¨
- âœ… å®æ—¶ä»£ç åˆ†æ
- âœ… é”™è¯¯é«˜äº®æ˜¾ç¤º
- âœ… 29 ä¸ªé¢„è®¾æµ‹è¯•ç”¨ä¾‹
- âœ… Token ç»Ÿè®¡ä¸ AST å±•ç¤º

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ç¼–è¯‘æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SysY ç¼–è¯‘å™¨å‰ç«¯                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   æºä»£ç     â”‚     â”‚   Token     â”‚     â”‚   æŠ½è±¡è¯­æ³•æ ‘ (AST)      â”‚   â”‚
â”‚   â”‚   (.sy)     â”‚â”€â”€â”€â”€â–¶â”‚    æµ       â”‚â”€â”€â”€â”€â–¶â”‚                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                   â”‚                         â”‚                â”‚
â”‚          â–¼                   â–¼                         â–¼                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è¯æ³•åˆ†æå™¨  â”‚     â”‚  è¯­æ³•åˆ†æå™¨  â”‚     â”‚      è¯­ä¹‰åˆ†æå™¨         â”‚   â”‚
â”‚   â”‚   (Lexer)   â”‚     â”‚   (Parser)  â”‚     â”‚  (SemanticAnalyzer)    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                   â”‚                         â”‚                â”‚
â”‚          â–¼                   â–¼                         â–¼                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Error Type Aâ”‚     â”‚ Error Type Bâ”‚     â”‚   Error Type 1-17       â”‚   â”‚
â”‚   â”‚  è¯æ³•é”™è¯¯   â”‚     â”‚  è¯­æ³•é”™è¯¯   â”‚     â”‚     è¯­ä¹‰é”™è¯¯            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—ä¾èµ–å…³ç³»

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   main.py    â”‚
                    â”‚   app.py     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Lexer    â”‚  â”‚   Parser   â”‚  â”‚ SemanticAnalyzer â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚                  â”‚
           â–¼               â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ TokenType  â”‚  â”‚ AST Nodes  â”‚  â”‚   SymbolTable    â”‚
    â”‚   Token    â”‚  â”‚            â”‚  â”‚     Symbol       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python** >= 3.14
- **uv** (æ¨è) æˆ– pip åŒ…ç®¡ç†å™¨

### å®‰è£…æ­¥éª¤

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ uvï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd lab4

# å®‰è£…ä¾èµ–ï¼ˆuv ä¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼‰
uv sync

# è¿è¡Œå‘½ä»¤è¡Œå·¥å…·
uv run python main.py test_cases/test_01_basic.sy

# è¿è¡Œ Web ç•Œé¢
uv run streamlit run app.py
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨ pip

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd lab4

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
source .venv/bin/activate  # Linux/macOS
# .venv\Scripts\activate   # Windows

# å®‰è£…ä¾èµ–
pip install streamlit

# è¿è¡Œå‘½ä»¤è¡Œå·¥å…·
python main.py test_cases/test_01_basic.sy

# è¿è¡Œ Web ç•Œé¢
streamlit run app.py
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
lab4/
â”œâ”€â”€ ğŸ“„ README.md                 # æœ¬æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ pyproject.toml            # é¡¹ç›®é…ç½®ä¸ä¾èµ–
â”œâ”€â”€ ğŸ“„ main.py                   # å‘½ä»¤è¡Œå…¥å£
â”œâ”€â”€ ğŸ“„ app.py                    # Streamlit Web ç•Œé¢
â”‚
â”œâ”€â”€ ğŸ“ src/                      # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ token_type.py           # Token ç±»å‹æšä¸¾ä¸ Token ç±»
â”‚   â”œâ”€â”€ lexer.py                # è¯æ³•åˆ†æå™¨
â”‚   â”œâ”€â”€ ast_nodes.py            # AST èŠ‚ç‚¹å®šä¹‰
â”‚   â”œâ”€â”€ parser.py               # è¯­æ³•åˆ†æå™¨ï¼ˆé€’å½’ä¸‹é™ï¼‰
â”‚   â”œâ”€â”€ symbol_table.py         # ç¬¦å·è¡¨ä¸ç±»å‹ç³»ç»Ÿ
â”‚   â””â”€â”€ semantic_analyzer.py    # è¯­ä¹‰åˆ†æå™¨
â”‚
â”œâ”€â”€ ğŸ“ test_cases/               # æµ‹è¯•ç”¨ä¾‹ï¼ˆ29ä¸ªï¼‰
â”‚   â”œâ”€â”€ test_01_basic.sy        # åŸºç¡€æµ‹è¯•
â”‚   â”œâ”€â”€ test_02_arithmetic.sy   # ç®—æœ¯è¿ç®—
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ test_error_01_*.sy      # é”™è¯¯ç±»å‹ 1 æµ‹è¯•
â”‚   â”œâ”€â”€ test_error_02_*.sy      # é”™è¯¯ç±»å‹ 2 æµ‹è¯•
â”‚   â””â”€â”€ ...                     # å…± 17 ç§é”™è¯¯ç±»å‹æµ‹è¯•
â”‚
â””â”€â”€ ğŸ“ å®éªŒæ–‡æ¡£/
    â”œâ”€â”€ SysY2022è¯­è¨€å®šä¹‰-V1.pdf
    â”œâ”€â”€ ä»»åŠ¡4.1 ... .pdf
    â”œâ”€â”€ ä»»åŠ¡4.2è¯æ³•åˆ†æå™¨è®¾è®¡ä¸å®ç°.pdf
    â”œâ”€â”€ ä»»åŠ¡4.3 è¯­æ³•åˆ†æå™¨è®¾è®¡ä¸å®ç°.pdf
    â””â”€â”€ ä»»åŠ¡4.4 è¯­ä¹‰åˆ†æ.pdf
```

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

| æ¨¡å— | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| **è¯æ³•åˆ†æ** | `src/lexer.py` | å°†æºä»£ç å­—ç¬¦æµè½¬æ¢ä¸º Token æµ |
| **Token å®šä¹‰** | `src/token_type.py` | å®šä¹‰ Token ç±»å‹æšä¸¾å’Œ Token æ•°æ®ç»“æ„ |
| **è¯­æ³•åˆ†æ** | `src/parser.py` | é€’å½’ä¸‹é™è§£æï¼Œæ„å»º AST |
| **AST å®šä¹‰** | `src/ast_nodes.py` | å®šä¹‰å„ç±» AST èŠ‚ç‚¹ç±» |
| **è¯­ä¹‰åˆ†æ** | `src/semantic_analyzer.py` | ç±»å‹æ£€æŸ¥ã€ç¬¦å·è¡¨ç®¡ç†ã€é”™è¯¯æ£€æµ‹ |
| **ç¬¦å·è¡¨** | `src/symbol_table.py` | ç¬¦å·å®šä¹‰ã€ç±»å‹ç³»ç»Ÿã€ä½œç”¨åŸŸç®¡ç† |

---

## ğŸ’» ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œæ¨¡å¼

```bash
# åŸºç¡€ç”¨æ³•ï¼šè¯­æ³•åˆ†æï¼ˆé»˜è®¤ï¼‰ï¼Œè¾“å‡º AST
python main.py <source_file.sy>

# ä»…è¯æ³•åˆ†æï¼Œè¾“å‡º Token åˆ—è¡¨
python main.py -l <source_file.sy>

# å®Œæ•´è¯­ä¹‰åˆ†æ
python main.py -s <source_file.sy>
```

#### å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | é•¿é€‰é¡¹ | è¯´æ˜ |
|------|--------|------|
| `-l` | `--lexer` | ä»…è¿è¡Œè¯æ³•åˆ†æï¼Œè¾“å‡º Token åˆ—è¡¨ |
| `-p` | `--parser` | è¿è¡Œè¯­æ³•åˆ†æï¼Œè¾“å‡º ASTï¼ˆé»˜è®¤è¡Œä¸ºï¼‰ |
| `-s` | `--semantic` | è¿è¡Œå®Œæ•´è¯­ä¹‰åˆ†æ |

#### è¾“å‡ºç¤ºä¾‹

**è¯æ³•åˆ†æè¾“å‡º** (`-l`):
```
INTTK int
IDENFR main
LPARENT (
RPARENT )
LBRACE {
INTTK int
IDENFR a
ASSIGN =
INTCON 10
SEMICN ;
...
```

**è¯­æ³•åˆ†æè¾“å‡º** (é»˜è®¤):
```
CompUnit (1)
  FuncDef (1)
    FuncType (1)
      Type: int
    Ident: main
    LPARENT
    RPARENT
    Block (2)
      LBRACE
      BlockItem (3)
        Decl (3)
          VarDecl (3)
            ...
```

**è¯­ä¹‰åˆ†æè¾“å‡º** (`-s`):
```
success                          # æ— é”™è¯¯æ—¶
Error type 1 at Line 5: ...     # æœ‰é”™è¯¯æ—¶
```

### Web ç•Œé¢æ¨¡å¼

```bash
streamlit run app.py
```

å¯åŠ¨åè®¿é—® `http://localhost:8501`ï¼Œå¯ä»¥ï¼š

1. ğŸ“ åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­è¾“å…¥ SysY ä»£ç 
2. ğŸ“‚ ä»é¢„è®¾çš„ 29 ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­å¯¼å…¥
3. ğŸ” å®æ—¶æŸ¥çœ‹åˆ†æç»“æœå’Œé”™è¯¯æŠ¥å‘Š
4. ğŸ“Š å±•å¼€æŸ¥çœ‹ Token åˆ—è¡¨ã€ASTã€ç¬¦å·è¡¨ç­‰è¯¦æƒ…

---

## ğŸ”´ é”™è¯¯æ£€æµ‹

æœ¬ç¼–è¯‘å™¨å‰ç«¯å¯æ£€æµ‹ä¸‰ç±»é”™è¯¯ï¼Œå…± **17 ç§è¯­ä¹‰é”™è¯¯ç±»å‹**ï¼ˆè¶…è¶Šå®éªŒè¦æ±‚çš„ 13 ç§ï¼‰ã€‚

### è¯æ³•é”™è¯¯ (Error Type A)

| é”™è¯¯æè¿° | ç¤ºä¾‹ |
|----------|------|
| éæ³•å­—ç¬¦ | `int a = ~1;` |
| éæ³•å…«è¿›åˆ¶æ•° | `int a = 09;` |
| éæ³•åå…­è¿›åˆ¶æ•° | `int a = 0x3G;` |
| æœªé—­åˆçš„æ³¨é‡Š | `/* comment` |

### è¯­æ³•é”™è¯¯ (Error Type B)

| é”™è¯¯æè¿° | ç¤ºä¾‹ |
|----------|------|
| ç¼ºå°‘åˆ†å· | `int a = 1` |
| ç¼ºå°‘æ‹¬å· | `if (a > 0 { }` |
| æ•°ç»„è®¿é—®è¯­æ³•é”™è¯¯ | `a[1, 2] = 0;` |
| è¡¨è¾¾å¼è¯­æ³•é”™è¯¯ | `int a = + ;` |

### è¯­ä¹‰é”™è¯¯ (Error Type 1-17)

| ç±»å‹ | é”™è¯¯æè¿° | ç¤ºä¾‹ |
|------|----------|------|
| **Error 1** | å˜é‡æœªå£°æ˜ | `j = 10;` (j æœªå®šä¹‰) |
| **Error 2** | å˜é‡é‡å¤å£°æ˜ | `int a; int a;` |
| **Error 3** | å‡½æ•°æœªå®šä¹‰ | `foo();` (foo æœªå®šä¹‰) |
| **Error 4** | å‡½æ•°é‡å¤å®šä¹‰ | `int f(){} int f(){}` |
| **Error 5** | å˜é‡å½“å‡½æ•°è°ƒç”¨ | `int a; a();` |
| **Error 6** | å‡½æ•°åå½“å˜é‡ | `int f(){} int x = f;` |
| **Error 7** | æ•°ç»„ä¸‹æ ‡éæ•´å‹ | `a[1.5] = 0;` |
| **Error 8** | éæ•°ç»„ä½¿ç”¨ä¸‹æ ‡ | `int a; a[0] = 1;` |
| **Error 9** | å‚æ•°æ•°é‡/ç±»å‹ä¸åŒ¹é… | `f(1, 2);` (f åªéœ€ 1 ä¸ªå‚æ•°) |
| **Error 10** | return ç±»å‹ä¸åŒ¹é… | `int f() { return 1.5; }` |
| **Error 11** | æ“ä½œæ•°ç±»å‹ä¸åŒ¹é… | `int a; float b; a + b;` |
| **Error 12** | break ä¸åœ¨å¾ªç¯å†… | `int main() { break; }` |
| **Error 13** | continue ä¸åœ¨å¾ªç¯å†… | `int main() { continue; }` |
| **Error 14** | æ•°ç»„è¶Šç•Œè®¿é—® | `int a[10]; a[15] = 0;` |
| **Error 15** | ä¿®æ”¹å¸¸é‡ | `const int a = 1; a = 2;` |
| **Error 16** | void è¿”å›å€¼è¢«ä½¿ç”¨ | `void f(){} int x = f();` |
| **Error 17** | ç¼ºå°‘ main å‡½æ•° | ç¨‹åºä¸­æ—  main å‡½æ•°å®šä¹‰ |

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

é¡¹ç›®åŒ…å« **29 ä¸ªç²¾å¿ƒè®¾è®¡çš„æµ‹è¯•ç”¨ä¾‹**ï¼Œåˆ†ä¸ºä¸‰ç±»ï¼š

### åŠŸèƒ½æµ‹è¯• (12 ä¸ª)

| æµ‹è¯•ç”¨ä¾‹ | æè¿° | è¦†ç›–ç‰¹æ€§ |
|----------|------|----------|
| `test_01_basic.sy` | åŸºç¡€æµ‹è¯• | å˜é‡å®šä¹‰ã€ç®€å•è¡¨è¾¾å¼ |
| `test_02_arithmetic.sy` | ç®—æœ¯è¿ç®— | å››åˆ™è¿ç®—ã€å–æ¨¡ |
| `test_03_control.sy` | æ§åˆ¶æµ | if-elseã€while å¾ªç¯ |
| `test_04_func.sy` | å‡½æ•°å®šä¹‰ | å‡½æ•°å£°æ˜ã€è°ƒç”¨ã€è¿”å› |
| `test_05_array.sy` | æ•°ç»„æ“ä½œ | ä¸€ç»´/å¤šç»´æ•°ç»„ |
| `test_06_const_global.sy` | å¸¸é‡ä¸å…¨å±€å˜é‡ | constã€å…¨å±€ä½œç”¨åŸŸ |
| `test_07_float.sy` | æµ®ç‚¹æ•° | float ç±»å‹æ”¯æŒ |
| `test_08_complex.sy` | å¤æ‚ç¨‹åº | ç»¼åˆæµ‹è¯• |
| `test_09_lex_error.sy` | è¯æ³•é”™è¯¯æµ‹è¯• | Error Type A |
| `test_10_syntax_error.sy` | è¯­æ³•é”™è¯¯æµ‹è¯• | Error Type B |
| `test_11_semantic_error.sy` | è¯­ä¹‰é”™è¯¯æµ‹è¯• | åŸºç¡€è¯­ä¹‰é”™è¯¯ |
| `test_12_all_semantic_errors.sy` | å…¨éƒ¨è¯­ä¹‰é”™è¯¯ | æ‰€æœ‰ 17 ç§é”™è¯¯ |

### ç‹¬ç«‹è¯­ä¹‰é”™è¯¯æµ‹è¯• (17 ä¸ª)

æ¯ç§è¯­ä¹‰é”™è¯¯ç±»å‹éƒ½æœ‰ä¸“é—¨çš„æµ‹è¯•ç”¨ä¾‹ï¼š

```
test_error_01_undefined_variable.sy    # Error 1: å˜é‡æœªå£°æ˜
test_error_02_redefined_variable.sy    # Error 2: å˜é‡é‡å¤å£°æ˜
test_error_03_undefined_function.sy    # Error 3: å‡½æ•°æœªå®šä¹‰
test_error_04_redefined_function.sy    # Error 4: å‡½æ•°é‡å¤å®šä¹‰
test_error_05_variable_as_function.sy  # Error 5: å˜é‡å½“å‡½æ•°è°ƒç”¨
test_error_06_function_as_variable.sy  # Error 6: å‡½æ•°åå½“å˜é‡
test_error_07_non_integer_index.sy     # Error 7: æ•°ç»„ä¸‹æ ‡éæ•´å‹
test_error_08_non_array_access.sy      # Error 8: éæ•°ç»„ä½¿ç”¨ä¸‹æ ‡
test_error_09_param_mismatch.sy        # Error 9: å‚æ•°ä¸åŒ¹é…
test_error_10_return_mismatch.sy       # Error 10: returnç±»å‹ä¸åŒ¹é…
test_error_11_type_mismatch.sy         # Error 11: æ“ä½œæ•°ç±»å‹ä¸åŒ¹é…
test_error_12_break_not_in_loop.sy     # Error 12: breakä¸åœ¨å¾ªç¯å†…
test_error_13_continue_not_in_loop.sy  # Error 13: continueä¸åœ¨å¾ªç¯å†…
test_error_14_array_out_of_bounds.sy   # Error 14: æ•°ç»„è¶Šç•Œè®¿é—®
test_error_15_modify_constant.sy       # Error 15: ä¿®æ”¹å¸¸é‡
test_error_16_void_return_used.sy      # Error 16: voidè¿”å›å€¼è¢«ä½¿ç”¨
test_error_17_no_main.sy               # Error 17: ç¼ºå°‘mainå‡½æ•°
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•
python main.py -s test_cases/test_01_basic.sy

# æ‰¹é‡è¿è¡Œæ‰€æœ‰æµ‹è¯•
for f in test_cases/*.sy; do
    echo "Testing: $f"
    python main.py -s "$f"
    echo "---"
done
```

---

## ğŸ”¬ æŠ€æœ¯å®ç°

### è¯æ³•åˆ†æå™¨ (Lexer)

é‡‡ç”¨**æœ‰é™çŠ¶æ€æœº**æ–¹æ³•æ‰‹å·¥å®ç°ï¼Œæ ¸å¿ƒç‰¹ç‚¹ï¼š

- **å•éæ‰«æ**ï¼šä¸€æ¬¡éå†å®Œæˆæ‰€æœ‰ Token è¯†åˆ«
- **å¤šè¿›åˆ¶æ•°æ”¯æŒ**ï¼šè‡ªåŠ¨è¯†åˆ«åè¿›åˆ¶ã€å…«è¿›åˆ¶ï¼ˆ`0` å‰ç¼€ï¼‰ã€åå…­è¿›åˆ¶ï¼ˆ`0x` å‰ç¼€ï¼‰
- **æµ®ç‚¹æ•°å¤„ç†**ï¼šæ”¯æŒç§‘å­¦è®¡æ•°æ³•å’Œåå…­è¿›åˆ¶æµ®ç‚¹æ•°
- **é”™è¯¯æ¢å¤**ï¼šé‡åˆ°éæ³•å­—ç¬¦æ—¶è·³è¿‡å¹¶ç»§ç»­åˆ†æ

```python
# æ ¸å¿ƒæ‰«æé€»è¾‘ç¤ºä¾‹
while self.peek() is not None:
    if char.isalpha() or char == '_':
        self.scan_identifier_or_keyword()
    elif char.isdigit():
        self.scan_number()
    else:
        self.scan_operator_or_delimiter()
```

### è¯­æ³•åˆ†æå™¨ (Parser)

é‡‡ç”¨**é€’å½’ä¸‹é™è§£æ**æ–¹æ³•ï¼Œç‰¹ç‚¹ï¼š

- **LL(1) æ–‡æ³•**ï¼šæ¯ä¸ªéç»ˆç»“ç¬¦å¯¹åº”ä¸€ä¸ªè§£æå‡½æ•°
- **é¢„æµ‹åˆ†æ**ï¼šé€šè¿‡ lookahead ä¸€ä¸ª Token å†³å®šäº§ç”Ÿå¼
- **AST æ„å»º**ï¼šè§£æè¿‡ç¨‹ä¸­ç›´æ¥æ„å»ºè¯­æ³•æ ‘èŠ‚ç‚¹

```python
# é€’å½’ä¸‹é™ç¤ºä¾‹ï¼šè§£æå‡½æ•°å®šä¹‰
def parse_func_def(self):
    func_type = self.parse_func_type()  # è§£æè¿”å›ç±»å‹
    name = self.expect(TokenType.ID)     # æœŸæœ›æ ‡è¯†ç¬¦
    self.expect(TokenType.LPAREN)        # æœŸæœ› (
    params = self.parse_func_params()    # è§£æå‚æ•°åˆ—è¡¨
    self.expect(TokenType.RPAREN)        # æœŸæœ› )
    body = self.parse_block()            # è§£æå‡½æ•°ä½“
    return FuncDefNode(func_type, name, params, body)
```

### è¯­ä¹‰åˆ†æå™¨ (Semantic Analyzer)

é‡‡ç”¨**è®¿é—®è€…æ¨¡å¼**éå† ASTï¼Œç‰¹ç‚¹ï¼š

- **ç¬¦å·è¡¨æ ˆ**ï¼šæ”¯æŒåµŒå¥—ä½œç”¨åŸŸï¼ˆå…¨å±€ â†’ å‡½æ•° â†’ å—ï¼‰
- **ç±»å‹ç³»ç»Ÿ**ï¼šåŒºåˆ†åŸºæœ¬ç±»å‹ã€æ•°ç»„ç±»å‹ã€å‡½æ•°ç±»å‹
- **å¤šéåˆ†æ**ï¼šå…ˆæ”¶é›†æ‰€æœ‰å£°æ˜ï¼Œå†æ£€æŸ¥ä½¿ç”¨

```python
# ä½œç”¨åŸŸç®¡ç†ç¤ºä¾‹
def visit_func_def(self, node):
    # åœ¨å½“å‰ä½œç”¨åŸŸå®šä¹‰å‡½æ•°ç¬¦å·
    self.symbol_table.define(func_symbol)
    
    # è¿›å…¥å‡½æ•°ä½œç”¨åŸŸ
    self.symbol_table.enter_scope()
    
    # å®šä¹‰å‚æ•°
    for param in params:
        self.symbol_table.define(param_symbol)
    
    # åˆ†æå‡½æ•°ä½“
    self.visit_block(node.body)
    
    # é€€å‡ºå‡½æ•°ä½œç”¨åŸŸ
    self.symbol_table.exit_scope()
```

### ç¬¦å·è¡¨è®¾è®¡

```python
class SymbolTable:
    def __init__(self):
        self.scopes = [{}]  # ä½œç”¨åŸŸæ ˆ
    
    def enter_scope(self):
        self.scopes.append({})
    
    def exit_scope(self):
        self.scopes.pop()
    
    def lookup(self, name):
        # ä»å†…å‘å¤–æŸ¥æ‰¾
        for scope in reversed(self.scopes):
            if name in scope:
                return scope[name]
        return None
    
    def define(self, symbol):
        # åœ¨å½“å‰ä½œç”¨åŸŸå®šä¹‰
        self.scopes[-1][symbol.name] = symbol
```

---

## ğŸ“Š æ€§èƒ½ä¸ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æºä»£ç è¡Œæ•° | ~1500 è¡Œ |
| æ”¯æŒçš„ Token ç±»å‹ | 35 ç§ |
| AST èŠ‚ç‚¹ç±»å‹ | 25 ç§ |
| è¯­ä¹‰é”™è¯¯ç±»å‹ | 17 ç§ |
| æµ‹è¯•ç”¨ä¾‹æ•°é‡ | 29 ä¸ª |

---

## ğŸ‘¥ å¼€å‘ä¿¡æ¯

### å®éªŒè¯¾ç¨‹

- **è¯¾ç¨‹åç§°**ï¼šç¼–è¯‘åŸç†
- **å®éªŒç¼–å·**ï¼šLab 4
- **å®éªŒå†…å®¹**ï¼šSysY ç¼–è¯‘å™¨å‰ç«¯

### å‚è€ƒèµ„æ–™

- [SysY 2022 è¯­è¨€å®šä¹‰](./SysY2022è¯­è¨€å®šä¹‰-V1.pdf)
- [GNU Flex è¯æ³•åˆ†æå·¥å…·æŒ‡å¯¼](./Flexè¯æ³•åˆ†æå·¥å…·æŒ‡å¯¼.pdf)
- ã€Šç¼–è¯‘åŸç†ã€‹é¾™ä¹¦ (Compilers: Principles, Techniques, and Tools)

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**ï¼šPython 3.14+
- **Web æ¡†æ¶**ï¼šStreamlit 1.40+
- **åŒ…ç®¡ç†**ï¼šuv / pip

---

## ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œæ•™å­¦ä½¿ç”¨ã€‚

---

<p align="center">
  <i>ğŸ“ ç¼–è¯‘åŸç†è¯¾ç¨‹å®éªŒé¡¹ç›® | SysY Compiler Frontend</i>
</p>